<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–°–í–û–Ø –ö–£–•–ù–Ø ‚Äî –¥–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow:700&display=swap" rel="stylesheet">
  <style>
    :root{
      --brand-olive:#556B2F;
      --brand-olive-light:#7B8A2F;
      --bg-cream:#f7efe0;
      --accent:#b3611f;
      --muted:#7c6a5c;
      --card-border:#6b7a29;
    }
    html,body{height:100%;}
    body {
      background: var(--bg-cream);
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      margin:0;
      min-height:100vh;
      color:#2b2b2b;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .header {
      text-align:center;
      padding:28px 12px 10px 12px;
      background: linear-gradient(90deg, var(--brand-olive) 0%, var(--brand-olive-light) 100%);
      box-shadow:0 2px 10px rgba(0,0,0,0.08);
      position:relative;
    }
    .logo-wrap {
      display:flex;
      align-items:center;
      justify-content:center;
      gap:14px;
      flex-wrap:wrap;
    }
    @keyframes logoPop { from{transform:scale(0.7); opacity:0;} to{transform:scale(1); opacity:1;} }
    .logo-img {
      width:84px;
      height:84px;
      object-fit:cover;
      border-radius:50%;
      border: none;
      background: transparent;
      padding: 0;
      box-shadow:0 6px 18px rgba(0,0,0,0.12);
      animation:logoPop .35s ease;
    }
    .header-title {
      font-size:2.0em;
      color:#fff;
      font-weight:800;
      letter-spacing:1px;
      text-shadow:0 1px 6px rgba(0,0,0,0.12);
      margin-bottom:0;
    }
    .header-desc {
      color:#fffbe6;
      font-size:1.02em;
      font-weight:700;
      letter-spacing:0.5px;
      margin-top:6px;
      opacity:0.95;
    }
    .promo-banner {
      text-align:center;
      margin-top:10px;
      margin-bottom:10px;
      letter-spacing:1px;
    }
    .promo-star { color:var(--accent); font-size:1.6em; vertical-align:middle; }
    .promo-text { color:#fffbe6; font-weight:700; margin:0 8px; }

    .menu-controls {
      max-width:1100px;
      margin:20px auto 10px;
      padding:0 12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:center;
    }
    .menu-controls button {
      background:var(--brand-olive);
      color:#fff;
      border:none;
      border-radius:8px;
      padding:8px 16px;
      font-size:0.95em;
      font-weight:700;
      cursor:pointer;
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      transition:all .2s;
    }
    .menu-controls button:hover {
      background:var(--brand-olive-light);
      transform:translateY(-2px);
    }
    .menu-controls button.active {
      background:var(--accent);
    }

    .menu {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap:18px;
      justify-items:center;
      align-items:start;
      grid-auto-rows: 1fr;
      max-width:1100px;
      margin:26px auto 80px;
      padding:0 12px;
      box-sizing:border-box;
    }

    .product {
      background: #fff;
      border-radius:14px;
      box-shadow:0 4px 18px rgba(0,0,0,0.06);
      width:100%;
      max-width:220px;
      padding:16px 12px 14px;
      display:flex; 
      flex-direction:column;
      justify-content:space-between;
      transition:transform .18s,box-shadow .18s;
      position:relative;
      border:2px solid var(--card-border);
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      box-sizing:border-box;
      height:100%;
    }
    .product:not(.unavailable):hover {
      transform:translateY(-6px) scale(1.02);
      box-shadow:0 10px 28px rgba(0,0,0,0.08);
      border-color:var(--brand-olive-light);
    }
    .product.unavailable { opacity:.6; pointer-events:none; }
    .product-img {
      width:100px; height:100px; object-fit:cover; border-radius:12px; margin-bottom:10px; background:#eee;
      border:2px solid var(--brand-olive);
      flex: 0 0 auto;
      cursor:pointer;
    }
    .product-name {
      font-size:1.05em; font-weight:700; color:var(--brand-olive); margin-bottom:6px; text-align:center;
      letter-spacing:1px; text-transform:uppercase;
    }
    .product-desc {
      color:var(--muted); font-size:.95em; margin-bottom:6px; text-align:center; min-height:36px;
      flex: 1 1 auto;
    }
    .product-price {
      font-size:1.05em; color:#222; margin-bottom:10px; font-weight:700; letter-spacing:0.5px;
    }
    .controls { display:flex; align-items:center; gap:8px; flex-wrap:wrap; justify-content:center; }
    .add-btn, .remove-btn {
      border:none; border-radius:8px; font-size:1em; padding:6px 12px; margin:0 4px; cursor:pointer; transition:filter .12s;
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      font-weight:700;
    }
    .add-btn { background:var(--brand-olive); color:#fff; box-shadow:0 2px 6px rgba(91,104,44,0.12); }
    .remove-btn { background:#fff; color:var(--brand-olive); border:1px solid var(--card-border); }
    .add-btn:active,.remove-btn:active{ transform:translateY(1px); }

    .favorite-btn {
      position:absolute;
      top:8px;
      right:8px;
      background:rgba(255,255,255,0.9);
      border:none;
      border-radius:50%;
      width:32px;
      height:32px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      font-size:1.2em;
      transition:all .2s;
      z-index:10;
    }
    .favorite-btn:hover {
      transform:scale(1.15);
      background:#fff;
    }
    .favorite-btn.active {
      color:#ff6b6b;
    }

    @keyframes addToCart {
      0% { transform:scale(1); }
      50% { transform:scale(1.2); }
      100% { transform:scale(1); }
    }
    .adding-animation {
      animation:addToCart .3s ease;
    }

    .cart-fab {
      position:fixed; bottom:22px; right:18px; background:none; border:none; box-shadow:none;
      width:72px; height:72px; display:flex; align-items:center; justify-content:center;
      cursor:pointer; z-index:100; padding:0;
      transition:transform .18s;
    }
    .cart-fab:hover .cart-preview {
      display:block;
    }
    .cart-fab svg { display:block; filter: drop-shadow(0 4px 18px rgba(0,0,0,0.12));}
    .cart-fab-circle { fill:var(--accent); stroke:#fff; stroke-width:2; }
    .cart-fab-count {
      position:absolute; right:6px; top:6px; background:#fff; color:var(--accent); font-weight:700;
      border-radius:50%; min-width:26px; height:26px; display:flex; align-items:center; justify-content:center;
      font-size:1em; box-shadow:0 2px 8px rgba(0,0,0,0.12); border:2px solid var(--accent);
      pointer-events:none;
    }

    .cart-preview {
      display:none;
      position:absolute;
      bottom:80px;
      right:0;
      background:#fff;
      border:2px solid var(--brand-olive);
      border-radius:12px;
      padding:12px;
      min-width:200px;
      max-width:300px;
      box-shadow:0 8px 24px rgba(0,0,0,0.15);
      font-size:0.9em;
    }
    .cart-preview-title {
      font-weight:700;
      color:var(--brand-olive);
      margin-bottom:8px;
      border-bottom:1px solid #ddd;
      padding-bottom:6px;
    }
    .cart-preview-item {
      display:flex;
      justify-content:space-between;
      margin:4px 0;
      color:#333;
    }
    .cart-preview-total {
      margin-top:8px;
      padding-top:8px;
      border-top:1px solid #ddd;
      font-weight:700;
      text-align:right;
    }

    .cart-modal-bg {
      position:fixed; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.35); z-index:200;
      display:flex; align-items:flex-start; justify-content:center; animation:fadein .22s;
    }
    @keyframes fadein { from{opacity:0;} to{opacity:1;} }
    .cart-modal {
      background: var(--bg-cream); border-radius:18px; padding:20px 16px 16px 16px; min-width:320px; max-width:95vw;
      box-shadow:0 12px 36px rgba(0,0,0,0.12); position:relative;
      border:2px solid var(--brand-olive);
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      max-height:86vh; overflow-y:auto;
      display:flex; flex-direction:column;
      margin-top:36px;
    }
    .cart-title { font-size:1.2em; color:var(--brand-olive); margin-bottom:10px; letter-spacing:1px; font-weight:800; }
    .cart-list { list-style:none; padding:0; margin:0 0 10px 0; }
    .cart-list li { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; color:#333; }
    .cart-total { font-size:1.05em; color:#222; margin-bottom:12px; text-align:right; font-weight:800; }
    .cart-close { position:absolute; right:10px; top:8px; font-size:1.4em; color:var(--brand-olive); background:none; border:none; cursor:pointer; }
    .order-form input, .order-form textarea, .order-form select {
      width:100%; padding:8px; margin-bottom:8px; border-radius:8px; border:1px solid #ddd; font-size:1em;
      background:#fff; font-family: 'PT Sans Narrow', Arial, sans-serif;
    }
    .order-btn {
      background:var(--accent); color:#fff; border:none; border-radius:8px; padding:10px 18px; font-size:1.03em; font-weight:800; cursor:pointer; width:100%; margin-top:8px;
      letter-spacing:1px;
    }
    .order-success { color:#2e7d32; font-size:1.05em; text-align:center; margin-top:10px; }
    .order-processing {
      text-align:center; padding:20px; color:var(--brand-olive);
    }
    .order-processing .spinner-small {
      width:36px; height:36px; border:4px solid rgba(0,0,0,0.08); border-top-color:var(--brand-olive);
      border-radius:50%; animation:spin 1s linear infinite; margin:0 auto 12px;
    }
    .order-processing-text {
      font-size:1.05em; font-weight:700; margin-bottom:8px;
    }
    .order-processing-subtext {
      font-size:0.95em; color:var(--muted);
    }
    .delivery-info {
      background:#fff;border:2px solid var(--brand-olive);border-radius:8px;padding:10px;margin:8px 0;font-size:0.95em;color:#333;line-height:1.5;
    }
    .delivery-info strong {
      color:var(--brand-olive);display:block;margin-bottom:6px;
    }
    .delivery-info-subtitle {
      font-size:0.9em;
    }
    .delivery-info-list {
      margin-top:4px;
    }
    .delivery-btn {
      background:var(--brand-olive);color:#fff;border:none;border-radius:8px;padding:10px;
      font-size:1em;font-weight:700;cursor:pointer;width:100%;margin:8px 0;
      font-family: 'PT Sans Narrow', Arial, sans-serif;letter-spacing:0.5px;
      display:flex;align-items:center;justify-content:center;gap:6px;
    }
    .delivery-btn:hover {
      background:var(--brand-olive-light);
    }
    .delivery-modal {
      display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:250;
      align-items:center;justify-content:center;animation:fadein .22s;
    }
    .delivery-modal.show {
      display:flex;
    }
    .delivery-modal-content {
      background:var(--bg-cream);border-radius:16px;padding:20px;max-width:90vw;width:400px;
      border:2px solid var(--brand-olive);box-shadow:0 12px 36px rgba(0,0,0,0.2);
      position:relative;max-height:80vh;overflow-y:auto;
    }
    .delivery-modal-close {
      position:absolute;right:10px;top:10px;font-size:24px;color:var(--brand-olive);
      background:none;border:none;cursor:pointer;line-height:1;
    }

    .saved-addresses {
      margin-bottom:8px;
    }
    .saved-address-item {
      background:#f5f5f5;
      padding:8px;
      border-radius:6px;
      margin-bottom:4px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      cursor:pointer;
      transition:background .2s;
    }
    .saved-address-item:hover {
      background:#e8e8e8;
    }
    .saved-address-delete {
      background:#ff6b6b;
      color:#fff;
      border:none;
      border-radius:4px;
      padding:4px 8px;
      cursor:pointer;
      font-size:0.85em;
    }

    .history-modal {
      display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:250;
      align-items:flex-start;justify-content:center;animation:fadein .22s;
      overflow-y:auto;
    }
    .history-modal.show {
      display:flex;
    }
    .history-modal-content {
      background:var(--bg-cream);border-radius:16px;padding:20px;max-width:90vw;width:500px;
      border:2px solid var(--brand-olive);box-shadow:0 12px 36px rgba(0,0,0,0.2);
      position:relative;margin:36px auto;
    }
    .history-item {
      background:#fff;
      border:1px solid #ddd;
      border-radius:8px;
      padding:12px;
      margin-bottom:10px;
    }
    .history-item-header {
      display:flex;
      justify-content:space-between;
      margin-bottom:8px;
      font-weight:700;
      color:var(--brand-olive);
    }
    .history-item-products {
      font-size:0.9em;
      color:#555;
      margin-bottom:8px;
    }
    .history-item-footer {
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .repeat-order-btn {
      background:var(--accent);
      color:#fff;
      border:none;
      border-radius:6px;
      padding:6px 12px;
      cursor:pointer;
      font-size:0.9em;
      font-weight:700;
    }

    .image-modal {
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.85);
      z-index:300;
      align-items:center;
      justify-content:center;
      animation:fadein .22s;
      cursor:pointer;
    }
    .image-modal.show {
      display:flex;
    }
    .image-modal img {
      max-width:90vw;
      max-height:90vh;
      border-radius:12px;
      box-shadow:0 12px 48px rgba(0,0,0,0.5);
    }

    .unavailable-label { display:none; }

    .product .prod-unavailable {
      position: absolute;
      left: 8px;
      right: 8px;
      top: 8px;
      background: var(--accent);
      color: #fff;
      font-size: .95em;
      border-radius: 10px;
      padding: 6px 8px;
      text-align: center;
      letter-spacing: 1px;
      z-index: 6;
      pointer-events: none;
    }

    #menuLoader{
      position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background:rgba(255,255,255,0.86); z-index:300; opacity:0; pointer-events:none; transition:opacity .22s ease;
      backdrop-filter: blur(4px);
    }
    #menuLoader.visible{ opacity:1; pointer-events:auto; }
    .loader-box{ text-align:center; color:var(--brand-olive); }
    .spinner{ width:48px; height:48px; border:5px solid rgba(0,0,0,0.08); border-top-color:var(--brand-olive); border-radius:50%; animation:spin 1s linear infinite; margin:0 auto 8px; }
    @keyframes spin{ to{ transform:rotate(360deg); } }

    @media (max-width:1000px) {
      .menu { grid-template-columns: repeat(3, minmax(140px, 1fr)); max-width:900px; }
    }
    @media (max-width:600px) {
      .menu { grid-template-columns: repeat(2, minmax(140px, 1fr)); gap:12px; max-width:720px; margin-bottom:120px; }
      .product { width:100%; max-width:220px; padding:10px 8px; }
      .product-img { width:72px; height:72px; }
      .cart-modal { min-width:92vw; padding:12px 8px 10px 8px; border-radius:16px; margin-top:12vw;}
      .cart-fab { width:56px; height:56px; bottom:12px; right:10px; top:auto !important;}
      .cart-fab-count { min-width:18px; height:18px; font-size:.9em; right:2px; top:2px; }
      .header-title { font-size:1.4em; }
      .cart-preview { bottom:70px; right:-10px; max-width:250px; }
    }
    @media (max-width:420px) {
      .menu { gap:10px; padding:0 8px; }
      .header-title { font-size:1.1rem; }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo-wrap">
      <img class="logo-img" src="logo.png" alt="–°–í–û–Ø –ö–£–•–ù–Ø">
      <div>
        <div class="header-title">–°–í–û–Ø –ö–£–•–ù–Ø</div>
        <div class="header-desc">–î–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã ‚Äî –≤–∫—É—Å–Ω–æ, –±—ã—Å—Ç—Ä–æ, —Ä—è–¥–æ–º</div>
      </div>
    </div>
    <div class="promo-banner">
      <span class="promo-star">‚òÖ</span>
      <span class="promo-text">–ú–ï–ù–Æ</span>
      <span class="promo-star">‚òÖ</span>
    </div>
  </div>

  <div class="menu-controls">
    <button onclick="filterMenu('all')" class="active" id="filterAll">–í—Å–µ –±–ª—é–¥–∞</button>
    <button onclick="filterMenu('favorites')" id="filterFavorites">‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</button>
    <button onclick="showOrderHistory()">üìã –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</button>
  </div>

  <!-- loader overlay -->
  <div id="menuLoader" aria-hidden="true">
    <div class="loader-box" role="status" aria-live="polite">
      <div class="spinner" aria-hidden="true"></div>
      <div class="loader-text">–ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–Ω—é‚Ä¶</div>
    </div>
  </div>

  <div class="menu" id="menu"></div>

  <button id="cartFab" class="cart-fab" style="display:none;" title="–ö–æ—Ä–∑–∏–Ω–∞" aria-label="–ö–æ—Ä–∑–∏–Ω–∞">
    <svg viewBox="0 0 48 48" width="56" height="56" style="display:block;margin:auto;">
      <circle cx="24" cy="24" r="22" class="cart-fab-circle"/>
      <path d="M16 18h16l-2 13a3 3 0 0 1-3 2h-6a3 3 0 0 1-3-2l-2-13zm3 0v-4a3 3 0 0 1 3-3h2a3 3 0 0 1 3 3v4" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/>
      <circle cx="19" cy="36" r="2" fill="#fff"/>
      <circle cx="29" cy="36" r="2" fill="#fff"/>
    </svg>
    <span id="cartFabCount" class="cart-fab-count" aria-hidden="true"></span>
    <div class="cart-preview" id="cartPreview"></div>
  </button>

  <div id="cartModalBg" class="cart-modal-bg" style="display:none;"></div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ -->
  <div id="deliveryModal" class="delivery-modal">
    <div class="delivery-modal-content">
      <button class="delivery-modal-close" onclick="closeDeliveryInfo()">&times;</button>
      <div class="delivery-info">
        <strong>üî∏ –î–æ—Å—Ç–∞–≤–∫–∞:</strong>
        <div class="delivery-info-subtitle">(–î–æ –≤—Ö–æ–¥–∞ –≤ –æ—Ç–µ–ª—å, –∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã)</div>
        <div style="background:#e8f5e9;padding:6px;border-radius:6px;margin:6px 0;font-size:0.92em;color:#2e7d32;text-align:center;">
          ‚è±Ô∏è –ó–∞–∫–∞–∑ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ 1-1,5 —á–∞—Å–∞
        </div>
        <div class="delivery-info-list">
          ‚Ä¢ –¶–µ–Ω—Ç—Ä - –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –æ—Ç 150 VND<br>
          &nbsp;&nbsp;(–î–æ 150 VND - 20 VND)<br>
          ‚Ä¢ –°–µ–≤–µ—Ä - –æ—Ç 40 VND<br>
          ‚Ä¢ –†–∞–π–æ–Ω - coopmart, –õ—É–∏–∑–∏–∞–Ω–∞, Z Beach - –æ—Ç 40 VND<br>
          ‚Ä¢ Big C, –∑–∞ Coopmart (–≤ —Å—Ç–æ—Ä–æ–Ω—É –Æ–≥–∞) - –æ—Ç 45 VND<br>
          ‚Ä¢ –Æ–≥, –ê–Ω–≤—å–µ–Ω - –æ—Ç 50 VND<br>
          ‚Ä¢ –ó–∞ –º–æ—Å—Ç–æ–º –ø–æ—Å–ª–µ Coopmart, My gia, –∑–∞ Big C - –æ—Ç 60 VND
        </div>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤ -->
  <div id="historyModal" class="history-modal">
    <div class="history-modal-content">
      <button class="delivery-modal-close" onclick="closeOrderHistory()">&times;</button>
      <div class="cart-title">–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</div>
      <div id="historyContent"></div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
  <div id="imageModal" class="image-modal" onclick="closeImageModal()">
    <img id="imageModalImg" src="" alt="">
  </div>

  <script>
    // --- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ---
    const SHEET_API_URL = 'https://sheets.googleapis.com/v4/spreadsheets/SPREADSHEET_ID/values/Sheet1?key=API_KEY';
    const SHEET_API_FALLBACK = 'https://script.google.com/macros/s/AKfycbyytR-HwA0y-TnHS_7nygs-_ZkPHDYzQQWFgV3GJSVuvdn93oX0kP92Ti9bQVqW7C_gFg/exec';

    const TELEGRAM_BOT_TOKEN = '8543195311:AAGzpZwTaUAgw3qp6AeKQA_BbFX35jtbJIk';
    const TELEGRAM_CHAT_ID = '7567253745';

    let menuData = [];
    let cart = JSON.parse(localStorage.getItem('cart') || '{}');
    let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
    let orderHistory = JSON.parse(localStorage.getItem('orderHistory') || '[]');
    let savedAddresses = JSON.parse(localStorage.getItem('savedAddresses') || '[]');
    let savedUserData = JSON.parse(localStorage.getItem('userData') || '{}');
    let orderCounter = parseInt(localStorage.getItem('orderCounter') || '0');
    let currentFilter = 'all';

    // –í—å–µ—Ç–Ω–∞–º—Å–∫–∏–π –¥–æ–Ω–≥ formatter
    const RUB_FMT = new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND', maximumFractionDigits: 0 });

    function toNumberSafe(v) {
      if (typeof v === 'number') return v;
      if (v == null) return 0;
      let s = String(v).replace(/\u00A0/g, '').trim();
      s = s.replace(/[^\d,.\-]/g, '');
      if (!s) return 0;
      s = s.replace(/,/g, '.');
      const parts = s.split('.');
      if (parts.length > 2) {
        const frac = parts.pop();
        s = parts.join('') + '.' + frac;
      }
      const n = parseFloat(s);
      return isNaN(n) ? 0 : n;
    }

    function escapeHtml(s){ return String(s || '').replace(/[&<>"']/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[c]); }

    function saveCart() {
      localStorage.setItem('cart', JSON.stringify(cart));
    }

    function saveFavorites() {
      localStorage.setItem('favorites', JSON.stringify(favorites));
    }

    function saveOrderHistory() {
      localStorage.setItem('orderHistory', JSON.stringify(orderHistory));
    }

    function saveSavedAddresses() {
      localStorage.setItem('savedAddresses', JSON.stringify(savedAddresses));
    }

    function saveUserData() {
      localStorage.setItem('userData', JSON.stringify(savedUserData));
    }

    // loader control
    function showLoader(){
      const l = document.getElementById('menuLoader');
      if(!l) return;
      l.classList.add('visible');
      l.setAttribute('aria-hidden','false');
    }
    function hideLoader(){
      const l = document.getElementById('menuLoader');
      if(!l) return;
      l.classList.remove('visible');
      l.setAttribute('aria-hidden','true');
    }

    async function loadMenu() {
      showLoader();
      const safetyTimeout = setTimeout(()=>{ hideLoader(); }, 20000);
      try {
        const res = await fetch(SHEET_API_URL);
        if (!res.
