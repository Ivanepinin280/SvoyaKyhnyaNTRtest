<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>СВОЯ КУХНЯ — доставка еды</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=PT+Sans+Narrow:700&display=swap" rel="stylesheet">
  <style>
    :root{
      --brand-olive:#556B2F;
      --brand-olive-light:#7B8A2F;
      --bg-cream:#f7efe0;
      --accent:#b3611f;
      --muted:#7c6a5c;
      --card-border:#6b7a29;
    }
    html,body{height:100%;}
    body {
      background: var(--bg-cream);
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      margin:0;
      min-height:100vh;
      color:#2b2b2b;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    @keyframes fadeInDown {
      from { opacity:0; transform:translateY(-30px); }
      to { opacity:1; transform:translateY(0); }
    }

    .header {
      text-align:center;
      padding:28px 12px 10px 12px;
      background: linear-gradient(90deg, var(--brand-olive) 0%, var(--brand-olive-light) 100%);
      box-shadow:0 2px 10px rgba(0,0,0,0.08);
      position:relative;
      animation: fadeInDown 0.6s ease;
    }
    .logo-wrap {
      display:flex;
      align-items:center;
      justify-content:center;
      gap:14px;
      flex-wrap:wrap;
    }
    @keyframes logoPop { 
      0% {transform:scale(0.7) rotate(-10deg); opacity:0;} 
      60% {transform:scale(1.1) rotate(5deg);}
      100% {transform:scale(1) rotate(0deg); opacity:1;} 
    }
    .logo-img {
      width:84px;
      height:84px;
      object-fit:cover;
      border-radius:50%;
      border: none;
      background: transparent;
      padding: 0;
      box-shadow:0 6px 18px rgba(0,0,0,0.12);
      animation:logoPop .6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    .header-title {
      font-size:2.0em;
      color:#fff;
      font-weight:800;
      letter-spacing:1px;
      text-shadow:0 1px 6px rgba(0,0,0,0.12);
      margin-bottom:0;
      animation: fadeInDown 0.6s ease 0.2s backwards;
    }
    .header-desc {
      color:#fffbe6;
      font-size:1.02em;
      font-weight:700;
      letter-spacing:0.5px;
      margin-top:6px;
      opacity:0.95;
      animation: fadeInDown 0.6s ease 0.3s backwards;
    }
    
    @keyframes starPulse {
      0%, 100% { transform:scale(1) rotate(0deg); }
      50% { transform:scale(1.2) rotate(180deg); }
    }
    .promo-banner {
      text-align:center;
      margin-top:10px;
      margin-bottom:10px;
      letter-spacing:1px;
      animation: fadeInDown 0.6s ease 0.4s backwards;
    }
    .promo-star { 
      color:var(--accent); 
      font-size:1.6em; 
      vertical-align:middle;
      display:inline-block;
      animation: starPulse 2s ease-in-out infinite;
    }
    .promo-star:first-child {
      animation-delay: 0s;
    }
    .promo-star:last-child {
      animation-delay: 1s;
    }
    .promo-text { color:#fffbe6; font-weight:700; margin:0 8px; }

    @keyframes slideInUp {
      from { opacity:0; transform:translateY(20px); }
      to { opacity:1; transform:translateY(0); }
    }

    .menu-controls {
      max-width:1100px;
      margin:20px auto 10px;
      padding:0 12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:center;
      animation: slideInUp 0.5s ease 0.3s backwards;
    }
    .menu-controls button {
      background:var(--brand-olive);
      color:#fff;
      border:none;
      border-radius:8px;
      padding:8px 16px;
      font-size:0.95em;
      font-weight:700;
      cursor:pointer;
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      transition:all .3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      position:relative;
      overflow:hidden;
    }
    .menu-controls button::before {
      content:'';
      position:absolute;
      top:50%;
      left:50%;
      width:0;
      height:0;
      border-radius:50%;
      background:rgba(255,255,255,0.3);
      transform:translate(-50%, -50%);
      transition:width 0.6s, height 0.6s;
    }
    .menu-controls button:hover::before {
      width:300px;
      height:300px;
    }
    .menu-controls button:hover {
      background:var(--brand-olive-light);
      transform:translateY(-3px) scale(1.05);
      box-shadow:0 5px 15px rgba(0,0,0,0.2);
    }
    .menu-controls button.active {
      background:var(--accent);
      transform:scale(1.1);
    }

    .menu {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap:18px;
      justify-items:center;
      align-items:start;
      grid-auto-rows: 1fr;
      max-width:1100px;
      margin:26px auto 80px;
      padding:0 12px;
      box-sizing:border-box;
    }

    @keyframes cardFadeIn {
      from { opacity:0; transform:translateY(30px) scale(0.9); }
      to { opacity:1; transform:translateY(0) scale(1); }
    }

    .product {
      background: #fff;
      border-radius:14px;
      box-shadow:0 4px 18px rgba(0,0,0,0.06);
      width:100%;
      max-width:220px;
      padding:16px 12px 14px;
      display:flex; 
      flex-direction:column;
      justify-content:space-between;
      transition:all .3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      position:relative;
      border:2px solid var(--card-border);
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      box-sizing:border-box;
      height:100%;
      animation: cardFadeIn 0.5s ease backwards;
    }
    .product:nth-child(1) { animation-delay: 0.1s; }
    .product:nth-child(2) { animation-delay: 0.15s; }
    .product:nth-child(3) { animation-delay: 0.2s; }
    .product:nth-child(4) { animation-delay: 0.25s; }
    .product:nth-child(5) { animation-delay: 0.3s; }
    .product:nth-child(6) { animation-delay: 0.35s; }
    
    .product:not(.unavailable):hover {
      transform:translateY(-8px) scale(1.03) rotate(1deg);
      box-shadow:0 12px 35px rgba(0,0,0,0.15);
      border-color:var(--brand-olive-light);
    }
    .product.unavailable { opacity:.6; pointer-events:none; }
    
    @keyframes imageZoom {
      0% { transform:scale(1); }
      100% { transform:scale(1.1); }
    }
    
    .product-img {
      width:100px; 
      height:100px; 
      object-fit:cover; 
      border-radius:12px; 
      margin-bottom:10px; 
      background:#eee;
      border:2px solid var(--brand-olive);
      flex: 0 0 auto;
      cursor:pointer;
      transition:all 0.4s ease;
    }
    .product:hover .product-img {
      transform:scale(1.1) rotate(3deg);
      box-shadow:0 8px 20px rgba(0,0,0,0.2);
    }
    
    .product-name {
      font-size:1.05em; 
      font-weight:700; 
      color:var(--brand-olive); 
      margin-bottom:6px; 
      text-align:center;
      letter-spacing:1px; 
      text-transform:uppercase;
      transition:color 0.3s;
    }
    .product:hover .product-name {
      color:var(--accent);
    }
    
    .product-desc {
      color:var(--muted); 
      font-size:.95em; 
      margin-bottom:6px; 
      text-align:center; 
      min-height:36px;
      flex: 1 1 auto;
    }
    .product-price {
      font-size:1.05em; 
      color:#222; 
      margin-bottom:10px; 
      font-weight:700; 
      letter-spacing:0.5px;
      text-align:center;
    }
    .controls { 
      display:flex; 
      align-items:center; 
      gap:8px; 
      flex-wrap:wrap; 
      justify-content:center; 
    }
    .add-btn, .remove-btn {
      border:none; 
      border-radius:8px; 
      font-size:1em; 
      padding:6px 12px; 
      margin:0 4px; 
      cursor:pointer; 
      transition:all .3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      font-weight:700;
    }
    .add-btn { 
      background:var(--brand-olive); 
      color:#fff; 
      box-shadow:0 2px 6px rgba(91,104,44,0.12); 
    }
    .add-btn:hover {
      transform:translateY(-2px) scale(1.1);
      box-shadow:0 4px 12px rgba(91,104,44,0.3);
    }
    .remove-btn { 
      background:#fff; 
      color:var(--brand-olive); 
      border:1px solid var(--card-border); 
    }
    .remove-btn:hover {
      transform:translateY(-2px) scale(1.1);
      background:var(--brand-olive);
      color:#fff;
    }
    .add-btn:active,.remove-btn:active{ 
      transform:translateY(1px) scale(0.95); 
    }

    @keyframes heartBeat {
      0%, 100% { transform:scale(1); }
      25% { transform:scale(1.2); }
      50% { transform:scale(0.95); }
      75% { transform:scale(1.1); }
    }

    .favorite-btn {
      position:absolute;
      top:8px;
      right:8px;
      background:rgba(255,255,255,0.9);
      border:none;
      border-radius:50%;
      width:32px;
      height:32px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      font-size:1.2em;
      transition:all .3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      z-index:10;
    }
    .favorite-btn:hover {
      transform:scale(1.2) rotate(10deg);
      background:#fff;
      box-shadow:0 4px 15px rgba(0,0,0,0.2);
    }
    .favorite-btn.active {
      color:#ff6b6b;
      animation: heartBeat 0.6s ease;
    }

    @keyframes addToCart {
      0% { transform:scale(1); }
      30% { transform:scale(1.3) rotate(5deg); }
      60% { transform:scale(0.9) rotate(-5deg); }
      100% { transform:scale(1) rotate(0deg); }
    }
    .adding-animation {
      animation:addToCart .5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes float {
      0%, 100% { transform:translateY(0px); }
      50% { transform:translateY(-10px); }
    }

    .cart-fab {
      position:fixed; 
      bottom:22px; 
      right:18px; 
      background:none; 
      border:none; 
      box-shadow:none;
      width:72px; 
      height:72px; 
      display:flex; 
      align-items:center; 
      justify-content:center;
      cursor:pointer; 
      z-index:100; 
      padding:0;
      transition:transform .3s ease;
      animation: float 3s ease-in-out infinite;
    }
    .cart-fab:hover {
      transform:scale(1.15) rotate(5deg);
      animation: none;
    }
    .cart-fab:hover .cart-preview {
      display:block;
    }
    .cart-fab svg { 
      display:block; 
      filter: drop-shadow(0 6px 20px rgba(0,0,0,0.25));
      transition:filter 0.3s;
    }
    .cart-fab:hover svg {
      filter: drop-shadow(0 8px 25px rgba(0,0,0,0.35));
    }
    .cart-fab-circle { 
      fill:var(--accent); 
      stroke:#fff; 
      stroke-width:2;
      transition:all 0.3s;
    }
    .cart-fab:hover .cart-fab-circle {
      fill:var(--brand-olive-light);
    }
    
    @keyframes bounce {
      0%, 100% { transform:scale(1); }
      50% { transform:scale(1.2); }
    }
    
    .cart-fab-count {
      position:absolute; 
      right:6px; 
      top:6px; 
      background:#fff; 
      color:var(--accent); 
      font-weight:700;
      border-radius:50%; 
      min-width:26px; 
      height:26px; 
      display:flex; 
      align-items:center; 
      justify-content:center;
      font-size:1em; 
      box-shadow:0 2px 8px rgba(0,0,0,0.12); 
      border:2px solid var(--accent);
      pointer-events:none;
      animation: bounce 0.5s ease;
    }

    @keyframes slideInRight {
      from { opacity:0; transform:translateX(20px); }
      to { opacity:1; transform:translateX(0); }
    }

    .cart-preview {
      display:none;
      position:absolute;
      bottom:80px;
      right:0;
      background:#fff;
      border:2px solid var(--brand-olive);
      border-radius:12px;
      padding:12px;
      min-width:200px;
      max-width:300px;
      box-shadow:0 8px 24px rgba(0,0,0,0.15);
      font-size:0.9em;
      animation: slideInRight 0.3s ease;
    }
    .cart-preview-title {
      font-weight:700;
      color:var(--brand-olive);
      margin-bottom:8px;
      border-bottom:1px solid #ddd;
      padding-bottom:6px;
    }
    .cart-preview-item {
      display:flex;
      justify-content:space-between;
      margin:4px 0;
      color:#333;
    }
    .cart-preview-total {
      margin-top:8px;
      padding-top:8px;
      border-top:1px solid #ddd;
      font-weight:700;
      text-align:right;
    }

    @keyframes modalFadeIn {
      from { opacity:0; }
      to { opacity:1; }
    }
    
    @keyframes modalSlideUp {
      from { opacity:0; transform:translateY(50px) scale(0.9); }
      to { opacity:1; transform:translateY(0) scale(1); }
    }

    .cart-modal-bg {
      position:fixed; 
      left:0; 
      top:0; 
      width:100vw; 
      height:100vh; 
      background:rgba(0,0,0,0.5); 
      z-index:200;
      display:flex; 
      align-items:flex-start; 
      justify-content:center; 
      animation:modalFadeIn .3s;
      backdrop-filter: blur(3px);
    }
    
    .cart-modal {
      background: var(--bg-cream); 
      border-radius:18px; 
      padding:20px 16px 16px 16px; 
      min-width:320px; 
      max-width:95vw;
      box-shadow:0 15px 50px rgba(0,0,0,0.3); 
      position:relative;
      border:2px solid var(--brand-olive);
      font-family: 'PT Sans Narrow', Arial, sans-serif;
      max-height:86vh; 
      overflow-y:auto;
      display:flex; 
      flex-direction:column;
      margin-top:36px;
      animation: modalSlideUp 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    .cart-title { 
      font-size:1.2em; 
      color:var(--brand-olive); 
      margin-bottom:10px; 
      letter-spacing:1px; 
      font-weight:800; 
    }
    .cart-list { 
      list-style:none; 
      padding:0; 
      margin:0 0 10px 0; 
    }
    .cart-list li { 
      display:flex; 
      justify-content:space-between; 
      align-items:center; 
      margin-bottom:8px; 
      color:#333;
      transition:all 0.3s;
    }
    .cart-list li:hover {
      background:rgba(255,255,255,0.5);
      padding:5px;
      border-radius:8px;
    }
    .cart-total { 
      font-size:1.05em; 
      color:#222; 
      margin-bottom:12px; 
      text-align:right; 
      font-weight:800; 
    }
    .cart-close { 
      position:absolute; 
      right:10px; 
      top:8px; 
      font-size:1.4em; 
      color:var(--brand-olive); 
      background:none; 
      border:none; 
      cursor:pointer;
      transition:all 0.3s;
    }
    .cart-close:hover {
      transform:rotate(90deg) scale(1.2);
      color:var(--accent);
    }

    /* minimal modal/image styles continuation */
    .image-modal {
      display:none;
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.7);
      z-index:300;
      align-items:center;
      justify-content:center;
    }
    .image-modal.show {
      display:flex;
    }
    .image-modal-content {
      max-width:90vw;
      max-height:90vh;
      border-radius:12px;
      overflow:hidden;
    }

    footer {
      text-align:center;
      padding:18px 12px;
      color:var(--muted);
      font-size:0.9em;
      border-top:1px solid rgba(0,0,0,0.05);
      background:linear-gradient(180deg, transparent, rgba(0,0,0,0.02));
    }

  </style>
</head>
<body>
  <header class="header">
    <div class="logo-wrap">
      <img class="logo-img" src="https://via.placeholder.com/84" alt="Логотип">
      <div>
        <h1 class="header-title">СВОЯ КУХНЯ</h1>
        <div class="header-desc">Доставка вкусной еды — теперь в донгах (VND)</div>
      </div>
    </div>

    <div class="promo-banner" aria-hidden="true">
      <span class="promo-star">★</span>
      <span class="promo-text">Свежие блюда каждый день</span>
      <span class="promo-star">★</span>
    </div>
  </header>

  <div class="menu-controls" role="toolbar" aria-label="Меню">
    <button class="active">Все</button>
    <button>Супы</button>
    <button>Салаты</button>
    <button>Десерты</button>
  </div>

  <main>
    <section class="menu" aria-label="Каталог блюд">
      <!-- Примеры карточек продуктов.
           Важно: data-price содержит цену в донгах (VND). -->
      <article class="product" data-id="p1">
        <button class="favorite-btn" aria-label="В избранное">♡</button>
        <img class="product-img" src="https://via.placeholder.com/100" alt="Блюдо 1">
        <div class="product-name">Фо Бо</div>
        <div class="product-desc">Ароматный говяжий суп с рисовой лапшой</div>
        <!-- Цены должны храниться в data-price (число - в донгах). -->
        <div class="product-price" data-price="120000"></div>
        <div class="controls">
          <button class="add-btn" data-action="add" data-price="120000">Добавить</button>
        </div>
      </article>

      <article class="product" data-id="p2">
        <button class="favorite-btn" aria-label="В избранное">♡</button>
        <img class="product-img" src="https://via.placeholder.com/100" alt="Блюдо 2">
        <div class="product-name">Бань Ми</div>
        <div class="product-desc">Хрустящий багет с начинкой</div>
        <div class="product-price" data-price="75000"></div>
        <div class="controls">
          <button class="add-btn" data-action="add" data-price="75000">Добавить</button>
        </div>
      </article>

      <article class="product" data-id="p3">
        <button class="favorite-btn" aria-label="В избранное">♡</button>
        <img class="product-img" src="https://via.placeholder.com/100" alt="Блюдо 3">
        <div class="product-name">Салат из папайи</div>
        <div class="product-desc">Освежающий салат с арахисом</div>
        <div class="product-price" data-price="68000"></div>
        <div class="controls">
          <button class="add-btn" data-action="add" data-price="68000">Добавить</button>
        </div>
      </article>

      <article class="product" data-id="p4">
        <button class="favorite-btn" aria-label="В избранное">♡</button>
        <img class="product-img" src="https://via.placeholder.com/100" alt="Блюдо 4">
        <div class="product-name">Кофе по-вьетнамски</div>
        <div class="product-desc">Крепкий кофе со сгущённым молоком</div>
        <div class="product-price" data-price="45000"></div>
        <div class="controls">
          <button class="add-btn" data-action="add" data-price="45000">Добавить</button>
        </div>
      </article>

      <article class="product" data-id="p5">
        <button class="favorite-btn" aria-label="В избранное">♡</button>
        <img class="product-img" src="https://via.placeholder.com/100" alt="Блюдо 5">
        <div class="product-name">Рис с морепродуктами</div>
        <div class="product-desc">Питательное блюдо с овощами</div>
        <div class="product-price" data-price="98000"></div>
        <div class="controls">
          <button class="add-btn" data-action="add" data-price="98000">Добавить</button>
        </div>
      </article>

      <article class="product" data-id="p6">
        <button class="favorite-btn" aria-label="В избранное">♡</button>
        <img class="product-img" src="https://via.placeholder.com/100" alt="Блюдо 6">
        <div class="product-name">Чао</div>
        <div class="product-desc">Рисовая каша с курицей</div>
        <div class="product-price" data-price="54000"></div>
        <div class="controls">
          <button class="add-btn" data-action="add" data-price="54000">Добавить</button>
        </div>
      </article>
    </section>
  </main>

  <!-- Кнопка корзины (FAB) -->
  <button class="cart-fab" aria-label="Открыть корзину" id="cartFab">
    <svg width="64" height="64" viewBox="0 0 64 64" aria-hidden="true">
      <circle class="cart-fab-circle" cx="32" cy="32" r="30"></circle>
      <g transform="translate(18,18)" fill="#fff">
        <rect x="0" y="0" width="28" height="14" rx="2"></rect>
        <circle cx="8" cy="34" r="4" fill="#fff"></circle>
        <circle cx="22" cy="34" r="4" fill="#fff"></circle>
      </g>
    </svg>
    <div class="cart-fab-count" id="cartCount">0</div>

    <div class="cart-preview" id="cartPreview" aria-hidden="true">
      <div class="cart-preview-title">В корзине</div>
      <div id="cartPreviewItems">Пусто</div>
      <div class="cart-preview-total" id="cartPreviewTotal"></div>
    </div>
  </button>

  <footer>
    &copy; СВОЯ КУХНЯ — цены в вьетнамских донгах (VND)
  </footer>

  <!-- Скрипт: форматирование цен в VND и минимальный пример использования -->
  <script>
  (function () {
    'use strict';

    // Форматирование цены в вьетнамский донг (VND)
    const formatter = new Intl.NumberFormat('vi-VN', {
      style: 'currency',
      currency: 'VND',
      maximumFractionDigits: 0
    });

    function parseNumberFromString(str) {
      // Извлекаем только цифры и возможные точки/запятые, затем приводим к числу.
      if (str == null) return 0;
      const cleaned = String(str).replace(/[^\d.,-]/g, '').replace(/,/g, '');
      const n = Number(cleaned);
      return isNaN(n) ? 0 : n;
    }

    function formatPrice(value) {
      const n = Number(value) || 0;
      return formatter.format(Math.round(n));
    }

    function renderAllPrices(root = document) {
      // 1) Все элементы с data-price — читаем атрибут и форматируем
      const attrEls = root.querySelectorAll('[data-price]');
      attrEls.forEach(el => {
        const raw = el.getAttribute('data-price');
        const num = parseNumberFromString(raw);
        el.textContent = formatPrice(num);
      });

      // 2) Элементы с классом product-price, у которых нет data-price — пробуем извлечь число из текста
      const priceEls = root.querySelectorAll('.product-price');
      priceEls.forEach(el => {
        if (!el.hasAttribute('data-price')) {
          const num = parseNumberFromString(el.textContent);
          if (num > 0) {
            el.setAttribute('data-price', String(num));
            el.textContent = formatPrice(num);
          }
        }
      });
    }

    // expose to window for other scripts
    window.currencyVND = {
      formatPrice,
      renderAllPrices,
      parseNumberFromString
    };

    // Initial render
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => window.currencyVND.renderAllPrices());
    } else {
      window.currencyVND.renderAllPrices();
    }

    // Простой пример: минимальная логика добавления в корзину (демонстрация использования форматтера).
    const cart = {
      items: [], // { id, name, price, qty }
      add(item) {
        const found = this.items.find(i => i.id === item.id);
        if (found) found.qty += item.qty;
        else this.items.push(item);
        this.render();
      },
      total() {
        return this.items.reduce((s, it) => s + it.price * it.qty, 0);
      },
      render() {
        const count = this.items.reduce((s, it) => s + it.qty, 0);
        document.getElementById('cartCount').textContent = String(count);

        const previewItems = document.getElementById('cartPreviewItems');
        previewItems.innerHTML = '';
        if (this.items.length === 0) {
          previewItems.textContent = 'Пусто';
        } else {
          this.items.forEach(it => {
            const div = document.createElement('div');
            div.className = 'cart-preview-item';
            div.innerHTML = '<div>' + escapeHtml(it.name) + (it.qty > 1 ? ' x' + it.qty : '') + '</div>' +
                            '<div>' + formatPrice(it.price * it.qty) + '</div>';
            previewItems.appendChild(div);
          });
        }

        const previewTotal = document.getElementById('cartPreviewTotal');
        previewTotal.textContent = this.items.length ? ('Итого: ' + formatPrice(this.total())) : '';
      }
    };

    // Escape helper
    function escapeHtml(text) {
      const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
      return String(text).replace(/[&<>"']/g, (m) => map[m]);
    }

    // Вешаем обработчики кнопок "Добавить"
    document.addEventListener('click', function (e) {
      const btn = e.target.closest('[data-action="add"]');
      if (!btn) return;
      const productEl = btn.closest('.product');
      const id = productEl ? (productEl.getAttribute('data-id') || '') : '';
      const nameEl = productEl ? productEl.querySelector('.product-name') : null;
      const name = nameEl ? nameEl.textContent.trim() : 'Товар';
      // price может быть в атрибуте кнопки или в карточке
      let price = parseNumberFromString(btn.getAttribute('data-price') || '');
      if (!price && productEl) {
        price = parseNumberFromString(productEl.querySelector('[data-price]')?.getAttribute('data-price') || '');
      }
      if (!price) price = 0;
      cart.add({ id, name, price: Math.round(price), qty: 1 });
    });

    // показываем preview при наведении на FAB
    const cartFab = document.getElementById('cartFab');
    const cartPreview = document.getElementById('cartPreview');
    if (cartFab && cartPreview) {
      cartFab.addEventListener('mouseenter', () => cartPreview.style.display = 'block');
      cartFab.addEventListener('mouseleave', () => cartPreview.style.display = '');
    }

    // MutationObserver: автоматически форматируем динамически добавленные элементы
    const mo = new MutationObserver(mutations => {
      for (const m of mutations) {
        if (m.addedNodes && m.addedNodes.length) {
          m.addedNodes.forEach(node => {
            if (node.nodeType === 1) { // Element
              window.currencyVND.renderAllPrices(node);
            }
          });
        }
      }
    });
    mo.observe(document.body, { childList: true, subtree: true });

  })();
  </script>
</body>
</html>
